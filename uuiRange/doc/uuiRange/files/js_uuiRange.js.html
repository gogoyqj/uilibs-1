<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js&#x2F;uuiRange.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.ico">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" width="100px" height="100px" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/$.fn.uuiRange.html">$.fn.uuiRange</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/uuiRange.html">uuiRange</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: js&#x2F;uuiRange.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x2F;**
 组件

 @module uuiRange
 @author sogou ufo team
 **&#x2F;
(function($) {
    &#x2F;**
     实现html 5的绑定input@type=range，支持多拖动头，rely on uuiDrag

     @class $.fn.uuiRange
     @constructor
     @param {Object} options 配置.
     @param {Array} options.range 起始区间，默认为 0 - 100.
     @param {Array} options.duration 选中区间或者点，长度为1或者2，默认为[0].
     @param {String|dom} options.container 容器，默认为绑定ui组件的元素.
     @param {String} options.dir range的防线，v为水平，h为竖直，默认水平.
     @param {Boolean} options.enable 使可用
     @param {Function} options.callback 设定值后执行回调,传递参数{Array}选中的range.
     @example $(&#x27;.uuiRange&#x27;).uuiRange({enable:0})
     * *&#x2F;
    function uuiRange($this, options) {
        var _ = this, _o;
        &#x2F;&#x2F; default setting
        _o = _.options = {
            range: [0, 100],
            dir: &#x27;v&#x27;,
            duration: [0],
            classPrefix: &#x27;uuiRange&#x27;,
            container: $this[0]
        };
        _.update(options || {});
        _.rangerHTML = &#x27;&lt;i style=&quot;position:absolute;&quot; class=&quot;&#x27; + _o.classPrefix + &#x27;-ranger&quot;&gt;&lt;&#x2F;i&gt;&#x27;;
        _.durationHTML = &#x27;&lt;div class=&quot;&#x27; + _o.classPrefix + &#x27;-duration&quot;&gt;&lt;&#x2F;div&gt;&#x27;;
        _.rangerParHTML = &#x27;&lt;div class=&quot;&#x27; + _o.classPrefix + &#x27;-par&quot;&gt;&lt;&#x2F;div&gt;&#x27;;
        _.init();
    };
    &#x2F;&#x2F; 如果不需要，可以删除
    uuiRange.prototype = {
        &#x2F;**
         * 初始化
         *
         * @method init
         * @protected
         * *&#x2F;
        init: function() {
            var _ = this
                , _o = _.options;
            _.rangeContainer = document.createElement(&#x27;div&#x27;);
            _.rangeContainer.className = _o.classPrefix + &#x27;-container&#x27;;
            var html = &#x27;&#x27;;
            html += _.durationHTML;
            html += _.rangerParHTML;
            for (var i = 0, len = Math.min(_o.duration.length, 2); i &lt; len; i++) {
                html += _.rangerHTML;
            }
            $(_o.container).append(_.rangeContainer);
            _.rangeContainer.innerHTML = html;
            _.ranger = $(_.rangeContainer).children(&#x27;i&#x27;);
            &#x2F;&#x2F; 当只有一个拖动头的时候支持click事件
            if (_o.duration.length == 1) {
                _.on($(_.rangeContainer).children(&#x27;.&#x27; + _o.classPrefix + &#x27;-par&#x27;), &#x27;click&#x27;, function(e) {
                    if (_o.enable) {
                        _.callback(e, _.ranger[0]);
                    }
                });
            }
            _.setValue();
        },
        &#x2F;**
         * 计算区间，事件绑定缓冲函数
         *
         * @method callback
         * @protected
         * @param {event} e 事件.
         * @param {dom} ele 事件发生的元素.
         * *&#x2F;
        callback: function(e,ele) {
            var _ = this
                , _o = _.options
                , v = _.getPos(e);
            _.setPos(ele, v);
            _.updataDuration();
        },
        &#x2F;**
         * 设置拖动头的位置
         *
         * @method setPos
         * @protected
         * @param {elements} ele 拖动头.
         * @param {Number} v px值.
         * *&#x2F;
        setPos: function(ele, v) {
            if (this.options.dir == &#x27;h&#x27;) {
                ele.style.top = v + &#x27;px&#x27;;
            } else {
                ele.style.left = v + &#x27;px&#x27;;
            }
        },
        &#x2F;**
         * 更新duration样式，并执行回调
         *
         * @method updataDuration
         * @protected
         * *&#x2F;
        updataDuration: function() {
            var _ = this
                , _o = _.options
                , css
                , arr = [];
            $.each(_.ranger, function(i, item) {
                var v = _o.dir == &#x27;h&#x27; ? parseInt(item.style.top) &gt;&gt; 0 : parseInt(item.style.left) &gt;&gt; 0;
                arr.push(v);
            });
            arr[1] = arr[1] || 0;
            arr = arr.sort(function(a, b) { return a - b});
            css = _o.dir == &#x27;h&#x27; ? {top: arr[0] + &#x27;px&#x27;, height: arr[1] - arr[0] + &#x27;px&#x27;} : {left: arr[0] + &#x27;px&#x27;, width: arr[1] - arr[0] + &#x27;px&#x27;};
            $(_.rangeContainer).children(&#x27;.&#x27; + _o.classPrefix + &#x27;-&#x27; + &#x27;duration&#x27;).css(css);
            _o.callback &amp;&amp; _o.callback(_.getDuration());
        },
        &#x2F;**
         * 设置区间值
         *
         * @method setValue
         * @protected
         * *&#x2F;
        setValue: function() {
            var _ = this
                , _o = _.options
                , total = _o.range[1] - _o.range[0];
            $.each(_.ranger, function(i,item) {
                _.exchangeRate();
                var v = (_o.duration[i] - _o.range[0]) &#x2F; total * (_.cw - _.rw * 2);
                _.setPos(item, v);
            });
            $(_.rangeContainer).uuiDrag({
                dir: _o.dir,
                dragger: &#x27;.&#x27; + _o.classPrefix + &#x27;-ranger&#x27;,
                enable: _o.enable,
                dragMove: function() {
                    _.updataDuration();
                },
                dragEnd: function() {
                    _.updataDuration();
                },
                range: _o.container
            });
            _.updataDuration();
        },
        &#x2F;**
         * 获取点击事件的位置
         *
         * @method getPos
         * @protected
         * @param {event} e 事件.
         * *&#x2F;
        getPos: function(e) {
            var _ = this
                , _o = _.options
                , dir = _o.dir;
                _.exchangeRate();
            ep = dir == &#x27;h&#x27; ? $.UUIBase.getEPos(e).top - _.co.top - _.rw : $.UUIBase.getEPos(e).left - _.co.left - _.rw;
            if (ep &lt; 0) ep = 0;
            if (ep &gt; _.cw - _.rw * 2) ep = _.cw - _.rw * 2;
            return ep;
        },
        &#x2F;**
         * 计算父容器和拖动头的宽度，并进行转换
         *
         * @method exchangeRate
         * @protected
         * *&#x2F;
        exchangeRate: function() {
            var _ = this
                , _o = _.options
                , dir = _o.dir;
            _.co = $(_.rangeContainer).offset();
            _.cw = dir == &#x27;h&#x27; ? $(_.rangeContainer).height() : $(_.rangeContainer).width();
            _.rw = dir == &#x27;h&#x27; ? _.ranger.height() &#x2F; 2 : _.ranger.width() &#x2F; 2;
        },
        &#x2F;**
         * 获取选中区间，并转换为range内的有效值
         *
         * @method getDuration
         * @protected
         * @return {Array} 选中的区间值.
         * *&#x2F;
        getDuration: function() {
            var _ = this
                , _o = _.options;
            _o.duration = [];
            $.each(_.ranger, function(i, item) {
                var v = (_o.dir == &#x27;h&#x27; ? parseInt(item.style.top) &gt;&gt; 0 : parseInt(item.style.left) &gt;&gt; 0) &#x2F; (_.cw - _.rw * 2) * (_o.range[1] - _o.range[0]) + _o.range[0];
                _o.duration.push(v);
            });
            return _o.duration.sort(function(a, b) {return a - b});
        },
        &#x2F;**
         更新实例实现，请通过$(&#x27;.uuiRange&#x27;).uuiRange({xxxx})调用

         @method update
         @param {Object} options 参数配置，可以update参数dir, range, duration, callback.
         @example $(&#x27;.uuiRange&#x27;).uuiRange().excUUICMD(&#x27;update&#x27;, {enable:1 }) = $(&#x27;.uuiRange&#x27;).uuiRange({enable: 1});
         * *&#x2F;
        update: function(options) {
            this.options = $.extend(this.options, options);
            this.options.range = this.options.range.sort(function(a, b) {return a - b});
            this.options.duration = this.options.duration.sort(function(a, b) {return a - b});
            this.ranger &amp;&amp; this.setValue();
        }
        &#x2F;*
        \&#x2F;**
         实例内部自我销毁的接口，可以不实现，如未实现，destroy操作会被定为到继承的_destroy上，但是不能销毁和dom的绑定，不建议调用，请使用$(&#x27;.uuiRange&#x27;).uuiRange({destroy: 1})

         @method destroy
         @param {Object} options 参数配置
         @example $(&#x27;.uuiRange&#x27;).uuiRange().excUUICMD(&#x27;destroy&#x27;);
         * *\&#x2F;
        destroy: function(options) {
            &#x2F;&#x2F; 组件自有的特殊的自我销毁逻辑
        }
        *&#x2F;
    };
    $.UUIBase.create(&#x27;uuiRange&#x27;, uuiRange);
    &#x2F;&#x2F; 创建css
    $($.UUIBase.init);
})(jQuery);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
